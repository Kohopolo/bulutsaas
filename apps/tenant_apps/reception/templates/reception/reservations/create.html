{% extends "tenant/base.html" %}

{% block title %}Yeni Rezervasyon{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto py-6">
  <div class="flex items-center justify-between mb-4">
    <h1 class="text-2xl font-semibold">Yeni Rezervasyon</h1>
    <a href="{% url 'reception:reservation_list' %}" class="text-sm text-blue-600 hover:underline">Listeye Dön</a>
  </div>

  {% if messages %}
    <div class="space-y-2 mb-4">
      {% for message in messages %}
        <div class="p-3 rounded {{ message.tags|default:'info' }} bg-gray-100">{{ message }}</div>
      {% endfor %}
    </div>
  {% endif %}

  <form method="post" class="bg-white shadow rounded p-6">
    {% csrf_token %}

    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <h2 class="text-lg font-medium mb-3">Konaklama Bilgileri</h2>
        {{ form.room.label_tag }}
        {{ form.room }}
        <div class="grid grid-cols-2 gap-4 mt-3">
          <div>
            {{ form.check_in_date.label_tag }}
            {{ form.check_in_date }}
          </div>
          <div>
            {{ form.check_out_date.label_tag }}
            {{ form.check_out_date }}
          </div>
        </div>
        <div class="grid grid-cols-3 gap-4 mt-3">
          <div>
            {{ form.adult_count.label_tag }}
            {{ form.adult_count }}
          </div>
          <div>
            {{ form.child_count.label_tag }}
            {{ form.child_count }}
          </div>
          <div>
            {{ form.child_ages.label_tag }}
            {{ form.child_ages }}
          </div>
        </div>

        <div class="mt-3">
          {{ form.board_type.label_tag }}
          {{ form.board_type }}
        </div>
        <div class="mt-3">
          {{ form.source.label_tag }}
          {{ form.source }}
        </div>
      </div>

      <div>
        <h2 class="text-lg font-medium mb-3">Misafir Bilgileri</h2>
        <div class="grid grid-cols-2 gap-4">
          <div>
            {{ form.customer_first_name.label_tag }}
            {{ form.customer_first_name }}
          </div>
          <div>
            {{ form.customer_last_name.label_tag }}
            {{ form.customer_last_name }}
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4 mt-3">
          <div>
            {{ form.customer_phone.label_tag }}
            {{ form.customer_phone }}
          </div>
          <div>
            {{ form.customer_email.label_tag }}
            {{ form.customer_email }}
          </div>
        </div>

        <div class="mt-3">
          {{ form.agency.label_tag }}
          {{ form.agency }}
        </div>
        <div class="mt-3">
          {{ form.channel.label_tag }}
          {{ form.channel }}
        </div>
      </div>
    </div>

    <div class="mt-6 grid grid-cols-1 md:grid-cols-2 gap-6">
      <div>
        <h2 class="text-lg font-medium mb-3">Fiyatlandırma</h2>
        <div class="grid grid-cols-2 gap-4">
          <div>
            {{ form.base_price.label_tag }}
            {{ form.base_price }}
          </div>
          <div>
            {{ form.extra_services_total.label_tag }}
            {{ form.extra_services_total }}
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4 mt-3">
          <div>
            {{ form.discount_amount.label_tag }}
            {{ form.discount_amount }}
          </div>
          <div>
            {{ form.reception_discount_rate.label_tag }}
            {{ form.reception_discount_rate }}
          </div>
        </div>
        <div class="grid grid-cols-2 gap-4 mt-3">
          <div>
            {{ form.reception_discount_amount.label_tag }}
            {{ form.reception_discount_amount }}
          </div>
          <div>
            {{ form.total_amount.label_tag }}
            {{ form.total_amount }}
          </div>
        </div>
      </div>

      <div>
        <h2 class="text-lg font-medium mb-3">Diğer</h2>
        <div class="grid grid-cols-2 gap-4">
          <div>
            {{ form.is_web_booking.label_tag }}
            {{ form.is_web_booking }}
          </div>
          <div>
            {{ form.is_complimentary.label_tag }}
            {{ form.is_complimentary }}
          </div>
        </div>
        <div class="mt-3">
          {{ form.notes.label_tag }}
          {{ form.notes }}
        </div>
      </div>
    </div>

    {% if form.errors %}
      <div class="mt-4 p-4 bg-red-50 text-red-700 rounded">
        Lütfen hataları düzeltin:
        <ul class="list-disc ml-5">
          {% for field, errors in form.errors.items %}
            <li><strong>{{ field }}:</strong> {{ errors|striptags }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <div class="mt-6 flex items-center gap-3">
      <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded">Kaydet</button>
      <a href="{% url 'reception:reservation_list' %}" class="px-4 py-2 bg-gray-200 text-gray-800 rounded">İptal</a>
    </div>
  </form>
</div>
{% endblock %}