{% comment %}
VB DataGridView Component
Usage:
    {% include 'vb_theme/components/datagrid.html' with 
        columns=columns 
        rows=rows 
        table_id="my-grid"
        sortable=True
        selectable=True
    %}
{% endcomment %}

<div class="vb-datagrid">
    <div class="vb-datagrid-container">
        <table id="{{ table_id|default:'vb-grid' }}">
            <thead>
                <tr>
                    {% if selectable %}
                    <th style="width: 40px;">
                        <input type="checkbox" id="select-all">
                    </th>
                    {% endif %}
                    
                    {% for column in columns %}
                    <th {% if column.sortable|default:sortable %}data-sortable="true"{% endif %}
                        {% if column.width %}style="width: {{ column.width }};"{% endif %}>
                        {{ column.label }}
                    </th>
                    {% endfor %}
                    
                    {% if actions %}
                    <th style="width: 120px; text-align: right;">İşlemler</th>
                    {% endif %}
                </tr>
            </thead>
            <tbody>
                {% if rows %}
                    {% for row in rows %}
                    <tr data-id="{{ row.id }}" {% if row.class %}class="{{ row.class }}"{% endif %}>
                        {% if selectable %}
                        <td>
                            <input type="checkbox" class="row-checkbox" value="{{ row.id }}">
                        </td>
                        {% endif %}
                        
                        {% for column in columns %}
                        <td {% if column.align %}style="text-align: {{ column.align }};"{% endif %}>
                            {% if column.template %}
                                {{ column.template|safe }}
                            {% elif column.field %}
                                {% with value=row|get_item:column.field %}
                                    {% if column.render %}
                                        {{ column.render|safe }}
                                    {% else %}
                                        {{ value }}
                                    {% endif %}
                                {% endwith %}
                            {% else %}
                                {{ row|get_item:forloop.counter0 }}
                            {% endif %}
                        </td>
                        {% endfor %}
                        
                        {% if actions %}
                        <td>
                            <div class="vb-datagrid-actions">
                                {% for action in actions %}
                                <button class="vb-button vb-button-icon 
                                    {% if action.type == 'edit' %}vb-button-primary
                                    {% elif action.type == 'delete' %}vb-button-danger
                                    {% elif action.type == 'view' %}vb-button-success
                                    {% endif %}"
                                    data-action="{{ action.type }}"
                                    data-id="{{ row.id }}"
                                    {% if action.tooltip %}data-tooltip="{{ action.tooltip }}"{% endif %}>
                                    <i class="{{ action.icon }}"></i>
                                </button>
                                {% endfor %}
                            </div>
                        </td>
                        {% endif %}
                    </tr>
                    {% endfor %}
                {% else %}
                    <tr>
                        <td colspan="{{ columns|length|add:selectable|add:actions }}" style="text-align: center; padding: 40px; color: #6c757d;">
                            <i class="fas fa-inbox" style="font-size: 48px; opacity: 0.3;"></i>
                            <p style="margin-top: 12px;">{{ empty_message|default:"Kayıt bulunamadı" }}</p>
                        </td>
                    </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>

{% if pagination %}
<div class="vb-datagrid-pagination" style="display: flex; justify-content: space-between; align-items: center; padding: 16px 0;">
    <div class="pagination-info">
        Toplam {{ pagination.total }} kayıt içinden {{ pagination.start }}-{{ pagination.end }} arası gösteriliyor
    </div>
    <div class="pagination-controls" style="display: flex; gap: 4px;">
        {% if pagination.has_previous %}
        <button class="vb-button vb-button-icon" onclick="location.href='?page=1'">
            <i class="fas fa-angle-double-left"></i>
        </button>
        <button class="vb-button vb-button-icon" onclick="location.href='?page={{ pagination.previous }}'">
            <i class="fas fa-angle-left"></i>
        </button>
        {% endif %}
        
        <span style="padding: 0 16px; line-height: 32px;">
            Sayfa {{ pagination.current }} / {{ pagination.total_pages }}
        </span>
        
        {% if pagination.has_next %}
        <button class="vb-button vb-button-icon" onclick="location.href='?page={{ pagination.next }}'">
            <i class="fas fa-angle-right"></i>
        </button>
        <button class="vb-button vb-button-icon" onclick="location.href='?page={{ pagination.total_pages }}'">
            <i class="fas fa-angle-double-right"></i>
        </button>
        {% endif %}
    </div>
</div>
{% endif %}


