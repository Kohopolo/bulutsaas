{% extends "tenant/base.html" %}
{% load static %}

{% block title %}Bungalov Listesi{% endblock %}

{% block content %}
<div class="content-body">
    <div class="groupbox">
        <div class="groupbox-header">
            <i class="fas fa-home"></i> Bungalov Listesi
            <div style="float: right;">
                <a href="{% url 'bungalovs:bungalov_create' %}" class="vb-button primary">
                    <i class="fas fa-plus"></i> Yeni Bungalov
                </a>
            </div>
        </div>
        <div class="groupbox-body">
            <!-- Filtreler -->
            <div style="margin-bottom: 15px; padding: 15px; background: #f8f9fa; border: 1px solid #d4d4d4; border-radius: 3px;">
                <form method="get">
                    <div style="display: grid; grid-template-columns: 2fr 1fr 1fr auto auto; gap: 10px; align-items: end;">
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-size: 12px; font-weight: bold;">Ara</label>
                            <input type="text" name="search" placeholder="Kod, ad, konum..." 
                                   value="{{ request.GET.search }}" 
                                   style="padding: 6px 10px; border: 1px solid #ced4da; border-radius: 3px; width: 100%; font-size: 13px;">
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-size: 12px; font-weight: bold;">Durum</label>
                            <select name="status" style="padding: 6px 10px; border: 1px solid #ced4da; border-radius: 3px; width: 100%; font-size: 13px;">
                                <option value="">Tüm Durumlar</option>
                                <option value="available" {% if request.GET.status == 'available' %}selected{% endif %}>Müsait</option>
                                <option value="occupied" {% if request.GET.status == 'occupied' %}selected{% endif %}>Dolu</option>
                                <option value="cleaning" {% if request.GET.status == 'cleaning' %}selected{% endif %}>Temizlikte</option>
                                <option value="maintenance" {% if request.GET.status == 'maintenance' %}selected{% endif %}>Bakımda</option>
                            </select>
                        </div>
                        <div>
                            <label style="display: block; margin-bottom: 5px; font-size: 12px; font-weight: bold;">Bungalov Tipi</label>
                            <select name="bungalov_type" style="padding: 6px 10px; border: 1px solid #ced4da; border-radius: 3px; width: 100%; font-size: 13px;">
                                <option value="">Tüm Tipler</option>
                                {% for type in bungalov_types %}
                                <option value="{{ type.id }}" {% if request.GET.bungalov_type == type.id|stringformat:"s" %}selected{% endif %}>{{ type.name }}</option>
                                {% endfor %}
                            </select>
                        </div>
                        <div>
                            <button type="submit" class="vb-button primary" style="width: 100%;">
                                <i class="fas fa-filter"></i> Filtrele
                            </button>
                        </div>
                        <div>
                            <a href="{% url 'bungalovs:bungalov_list' %}" class="vb-button" style="width: 100%;">
                                <i class="fas fa-times"></i> Temizle
                            </a>
                        </div>
                    </div>
                </form>
            </div>
            
            <!-- Bungalov Listesi -->
            {% if bungalovs %}
            <table class="vb-datagrid">
                <thead>
                    <tr>
                        <th>Kod</th>
                        <th>Ad</th>
                        <th>Tip</th>
                        <th>Konum</th>
                        <th>Durum</th>
                        <th>Aktif</th>
                        <th>İşlemler</th>
                    </tr>
                </thead>
                <tbody>
                    {% for bungalov in bungalovs %}
                    <tr>
                        <td><strong>{{ bungalov.code }}</strong></td>
                        <td>{{ bungalov.name }}</td>
                        <td>{{ bungalov.bungalov_type.name }}</td>
                        <td>{{ bungalov.location|default:"-" }}</td>
                        <td>
                            <span class="badge badge-{% if bungalov.status == 'available' %}success{% elif bungalov.status == 'occupied' %}danger{% elif bungalov.status == 'cleaning' %}warning{% else %}secondary{% endif %}">
                                {{ bungalov.get_status_display }}
                            </span>
                        </td>
                        <td>
                            {% if bungalov.is_active %}
                                <span style="color: green;"><i class="fas fa-check-circle"></i></span>
                            {% else %}
                                <span style="color: red;"><i class="fas fa-times-circle"></i></span>
                            {% endif %}
                        </td>
                        <td>
                            <a href="{% url 'bungalovs:bungalov_detail' bungalov.pk %}" class="vb-button small">
                                <i class="fas fa-eye"></i>
                            </a>
                            <a href="{% url 'bungalovs:bungalov_update' bungalov.pk %}" class="vb-button small">
                                <i class="fas fa-edit"></i>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            <!-- Sayfalama -->
            {% if bungalovs.has_other_pages %}
            <div style="margin-top: 20px; text-align: center;">
                {% if bungalovs.has_previous %}
                    <a href="?page={{ bungalovs.previous_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" class="vb-button">
                        <i class="fas fa-chevron-left"></i> Önceki
                    </a>
                {% endif %}
                
                <span style="margin: 0 15px;">
                    Sayfa {{ bungalovs.number }} / {{ bungalovs.paginator.num_pages }}
                </span>
                
                {% if bungalovs.has_next %}
                    <a href="?page={{ bungalovs.next_page_number }}{% if request.GET.search %}&search={{ request.GET.search }}{% endif %}" class="vb-button">
                        Sonraki <i class="fas fa-chevron-right"></i>
                    </a>
                {% endif %}
            </div>
            {% endif %}
            {% else %}
            <p style="text-align: center; padding: 40px; color: #666;">
                <i class="fas fa-inbox" style="font-size: 48px; color: #ccc; margin-bottom: 15px; display: block;"></i>
                Bungalov bulunamadı.
            </p>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}

